islamic spain became a major economic and intellectual center with the city of cordoba being among the largest and richest in europe